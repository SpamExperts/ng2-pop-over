{"version":3,"sources":["../src/pop-over.component.ts"],"names":[],"mappings":"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","file":"pop-over.component.js","sourceRoot":"","sourcesContent":["import {\n    Component, OnInit, OnDestroy, Input, ViewChild, ElementRef, Renderer, AfterViewInit\n} from '@angular/core';\nimport { Observable, Subject, Subscription, BehaviorSubject } from 'rxjs/Rx';\n\nexport class PopOverComponent implements OnInit, OnDestroy, AfterViewInit {\n    private showOnSubscription: Subscription;\n    private hideOnSubscription: Subscription;\n    private originalParent: Node;\n    private clickSubscription: Subscription;\n    \n    set showOn(value: Observable<MouseEvent>){\n        this.showOnSubscription && this.showOnSubscription.unsubscribe();\n        value && (this.showOnSubscription = value.subscribe(this.show.bind(this)));\n    };\n    \n    set hideOn(value: Observable<MouseEvent>){\n        this.hideOnSubscription && this.hideOnSubscription.unsubscribe();\n        value && (this.hideOnSubscription = value.subscribe(this.hide.bind(this)));\n    };\n     keepOnClickOutside: boolean;\n     anchorTo: boolean|Node = false;\n     my: string;\n     at: string;\n     xOffset: number = 0;\n     yOffset: number = 0;\n     contentClass: string;\n     content: any;\n    visible$: Subject<boolean> = new BehaviorSubject<boolean>(false);\n\n    constructor(private elRef: ElementRef, private renderer: Renderer) {\n    }\n\n    ngOnInit() {\n    }\n\n    ngOnDestroy() {\n        this.hideOnSubscription && this.hideOnSubscription.unsubscribe();\n        this.showOnSubscription && this.showOnSubscription.unsubscribe();\n    }\n\n    ngAfterViewInit(): any {\n        this.renderer.setElementStyle(this.content.nativeElement, 'opacity', '0');\n        this.renderer.setElementStyle(this.content.nativeElement, 'visibility', 'hidden');\n        return undefined;\n    }\n\n    private isPosition(parts: Array<string>, type: string): boolean {\n        return parts.indexOf(type) >= 0;\n    }\n\n    private computeAtPosition(target: any, position: string, xOffset: number = 0, yOffset: number = 0): [number, number] {\n        let x: number;\n        let y: number;\n\n        let positionParts = (position || '').split(/\\s+/);\n        if (positionParts.length > 2) {\n            console.warn('bad position: ', position);\n        }\n\n        let targetPosition = target.getBoundingClientRect();\n        if (this.isPosition(positionParts, 'left')) {\n            x = targetPosition.left - xOffset;\n        } else if (this.isPosition(positionParts, 'right')) {\n            x = targetPosition.right + xOffset;\n        } else {\n            x = (targetPosition.left + targetPosition.right) / 2;\n        }\n\n        if (this.isPosition(positionParts, 'top')) {\n            y = targetPosition.top - yOffset;\n        } else if (this.isPosition(positionParts, 'bottom')) {\n            y = targetPosition.bottom + yOffset;\n        } else {\n            y = (targetPosition.top + targetPosition.bottom) / 2;\n        }\n\n        return [x, y];\n    }\n\n    private computePosition(el: any, event: MouseEvent): [number, number] {\n        let baseX: number;\n        let baseY: number;\n        let boundryMargin: number = 5;\n        let bodyPosition = el.ownerDocument.body.getClientRects()[0];\n\n        if (this.anchorTo) {\n            let target: any = (this.anchorTo instanceof Node ? this.anchorTo: event.target);\n            [baseX, baseY] = this.computeAtPosition(target, this.at);\n        } else {\n            [baseX, baseY] = [event.clientX, event.clientY];\n        }\n\n        let [offsetX, offsetY] = this.computeAtPosition(el,\n            (this.my) || '', this.xOffset, this.yOffset);\n        let elPosition = el.getBoundingClientRect();\n        let pagePosition = el.ownerDocument.body.getBoundingClientRect();\n        let documentElement = el.ownerDocument.documentElement;\n        offsetX = offsetX - elPosition.left + pagePosition.left;\n        offsetY = offsetY - elPosition.top + pagePosition.top;\n        return [\n            Math.max(boundryMargin - bodyPosition.left, Math.min(\n                baseX - offsetX,\n                documentElement.clientWidth - bodyPosition.left - elPosition.width - boundryMargin)),\n            Math.max(boundryMargin - bodyPosition.top, Math.min(\n                baseY - offsetY,\n                documentElement.clientHeight - bodyPosition.top - elPosition.height - boundryMargin))\n        ];\n    }\n\n    hide() {\n        this.renderer.setElementStyle(this.content.nativeElement, 'opacity', '0');\n        this.renderer.setElementStyle(this.content.nativeElement, 'visibility', 'hidden');\n        this.visible$.next(false);\n        this.originalParent && this.originalParent.appendChild(this.content.nativeElement);\n    }\n\n    show(event: MouseEvent) {\n        this.clickSubscription && this.clickSubscription.unsubscribe();\n        this.visible$.next(true);\n        let el = this.content.nativeElement;\n        this.originalParent = el.parentNode;\n        el.ownerDocument.body.appendChild(el);\n        this.renderer.setElementStyle(this.content.nativeElement, 'visibility', 'inherit');\n        Observable.timer(0).take(1).subscribe(() => {\n            var [x, y] = this.computePosition(el, event);\n            this.renderer.setElementStyle(el, 'top', y + 'px');\n            this.renderer.setElementStyle(el, 'left', x + 'px');\n            this.renderer.setElementStyle(el, 'opacity', '1');\n            if (!this.keepOnClickOutside) {\n                this.clickSubscription = Observable.fromEvent(el.ownerDocument, 'click')\n                    .skipUntil(Observable.timer(0))\n                    .filter((md: MouseEvent) => !el.contains(md.target))\n                    .take(1)\n                    .subscribe((v) => (this.hide()))\n            }\n        })\n    }\n\n    toggle(event: MouseEvent) {\n        this.visible$\n            .take(1)\n            .subscribe((visible: boolean) => (visible ? this.hide() : this.show(event)));\n    }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n    selector: 'pop-over',\n    styles: [\n        `.pop-over-content {\n            position: absolute;\n            transition: opacity 0.2s ease-in-out;\n            background: #FFFFFF;\n        }`\n    ],\n    template: `<div class=\"pop-over\">\n        <div #popOverContent class=\"pop-over-content\" [ngClass]=\"contentClass\"\n             [class.shown]=\"visible$ | async\">\n            <ng-content *ngIf=\"visible$ | async\"></ng-content>\n        </div>\n    </div>`\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: Renderer, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'showOn': [{ type: Input, args: ['show-on', ] },],\n'hideOn': [{ type: Input, args: ['hide-on', ] },],\n'keepOnClickOutside': [{ type: Input, args: ['keep-on-click-outside', ] },],\n'anchorTo': [{ type: Input, args: ['anchor-to', ] },],\n'my': [{ type: Input },],\n'at': [{ type: Input },],\n'xOffset': [{ type: Input, args: ['x-offset', ] },],\n'yOffset': [{ type: Input, args: ['y-offset', ] },],\n'contentClass': [{ type: Input, args: ['content-class', ] },],\n'content': [{ type: ViewChild, args: ['popOverContent', ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}